{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
    
        // -----------------------------------------------------------------------------------------
        {
            "name": "Python: Current File",
            "type": "python",
            "request": "launch",
            "program": "${file}",
            "console": "integratedTerminal",
            "justMyCode": true
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "cifar, run",
            "type": "python",
            "request": "launch",
            "program": "./projects/cifar_classify/custom_cifar_run.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "6"},
            "args": [
                "--log_dir", "/export/Lab-Xue/projects/cifar/logs"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "mri, run",
            "type": "python",
            "request": "launch",
            "program": "./projects/mri/run.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "6"},
            "args": [
                "--data_root", "/data/mri/data", "--log_dir", "/export/Lab-Xue/projects/mri/logs", "--data_dir", "/export/Lab-Xue/projects/mri/results", "--summary_depth", "6", "--device", "cuda", "--project", "mri", "--num_epochs", "1", "--batch_size", "2", "--window_size", "8", "8", "--patch_size", "2", "2", "--optim.lr", "0.0001", "--optim.weight_decay", "1", "--use_amp", "--iters_to_accumulate", "1", "--num_workers", "48", "--prefetch_factor", "4", "--scheduler_type", "ReduceLROnPlateau", "--scheduler.patience", "0", "--scheduler.cooldown", "0", "--scheduler.factor", "0.95", "--min_noise_level", "2.0", "--max_noise_level", "14.0", "--mri_height", "32", "64", "--mri_width", "32", "64", "--time", "12", "--num_uploaded", "12", "--snr_perturb", "0.15", "--train_files", "BWH_RTCine_3T_2021_with_2x_resized.h5", "--train_data_types", "2dt", "--test_files", "train_3D_3T_retro_cine_2020_small_3D_test_with_2x_resized.h5", "train_3D_3T_retro_cine_2020_small_2DT_test_with_2x_resized.h5", "train_3D_3T_retro_cine_2020_small_2D_test_with_2x_resized.h5", "train_3D_3T_retro_cine_2020_500_samples_with_2x_resized.h5", "--test_data_types", "3d", "2dt", "2d", "2dt", "--ratio", "1", "5", "100", "--optim_type", "sophia", "--a_type", "conv", "--cell_type", "parallel", "--cosine_att", "1", "--att_with_relative_postion_bias", "0", "--norm_mode", "instance2d", "--mixer_type", "conv", "--shuffle_in_window", "0", "--scale_ratio_in_mixer", "1.0", "--mixer_kernel_size", "3", "--mixer_padding", "1", "--mixer_stride", "1", "--normalize_Q_K", "--backbone_hrnet.block_str", "T1L1G1", "T1L1G1", "T1L1G1", "T1L1G1", "--complex_i", "--run_name", "test_mixed_unetr", "--run_notes", "test_mixed_unetr", "--snr_perturb_prob", "0.0", "--n_head", "32", "--weighted_loss_snr", "--weighted_loss_temporal", "--weighted_loss_added_noise", "--residual", "--readout_resolution_ratio", "0.85", "0.7", "0.65", "0.55", "--phase_resolution_ratio", "0.85", "0.7", "0.65", "0.55", "--kspace_filter_sigma", "1.5", "2.0", "2.5", "3.0", "--kspace_T_filter_sigma", "1.0", "1.25", "1.5",  "--losses", "mse", "perpendicular", "l1", "--loss_weights", "1.0", "1.0", "1.0", "1.0", "10.0", "10.0", "--post_hrnet.separable_conv", "--backbone_model", "STCNNT_HRNET", "--model_type", "STCNNT_MRI", "--disable_LSUV", "--separable_conv", "--super_resolution", "--post_backbone", "STCNNT_mUNET", "--not_add_noise", "--with_data_degrading", "--upsample_method", "NN", "--override", "--clip_grad_norm",  "1.0", "--optim.weight_decay", "0.1"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "run_mri",
            "type": "python",
            "request": "launch",
            "program": "./projects/mri/inference/run_mri.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "3"},
            "args": [
                "--standalone", "--nproc_per_node", "4", "--data_root", "/export/Lab-Xue/projects/mri/data", "--tra_ratio", "5", "--run_extra_note", "refactor_v1", "--run_list", "0", "--model_type", "MRI_hrnet", "--min_noise_level", "12.0", "--losses", "mse", "perpendicular", "psnr", "l1", "gaussian", "gaussian3D", "ssim", "--loss_weights", "0.1", "1.0", "1.0", "1.0", "10.0", "10.0", "1.0", "--model_backbone", "STCNNT_UNET", "--model_block_str", "T1T1T1", "T1T1T1", "--lr_pre", "1e-5", "--lr_backbone", "1e-4", "--lr_post", "1e-4", "--batch_size", "4"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "run.py, mri",
            "type": "python",
            "request": "launch",
            "program": "./projects/mri/run.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--data_dir", "/data1/mri", 
                "--log_dir", "/export/Lab-Xue/projects/mri-main/logs", 
                "--summary_depth", "6", 
                "--device", "cuda", 
                "--ddp", 
                "--project", "mri-main", 
                "--window_size", "8", "8", "--patch_size", "2", "2", 
                "--clip_grad_norm", "1.0", 
                "--optim.weight_decay", "1", 
                "--dropout_p", "0.1", 
                "--activation_func", "prelu", 
                "--iters_to_accumulate", "1", 
                "--prefetch_factor", "8", 
                "--scheduler_type", "ReduceLROnPlateau", 
                "--mri_height", "32", "64", 
                "--mri_width", "32", "64", 
                "--time", "12", 
                "--num_uploaded", "12", 
                "--snr_perturb", "10.0", 
                "--post_hrnet.block_str", "T1L1G1", "T1L1G1", 
                "--ratio", "0.1", "0.2", "5", 
                "--max_load", "-1", 
                "--model_type", "STCNNT_MRI", 
                "--train_files", "train_3D_3T_retro_cine_2018.h5", //"train_3D_3T_retro_cine_2019.h5", "train_3D_3T_retro_cine_2020.h5", "BARTS_RetroCine_3T_2023.h5", "BARTS_RetroCine_1p5T_2023.h5", "MINNESOTA_UHVC_RetroCine_1p5T_2023.h5", "MINNESOTA_UHVC_RetroCine_1p5T_2022.h5", 
                "--test_files", "train_3D_3T_retro_cine_2020_small_3D_test.h5", "train_3D_3T_retro_cine_2020_small_2DT_test.h5", "train_3D_3T_retro_cine_2020_small_2D_test.h5", "train_3D_3T_retro_cine_2020_500_samples.h5", 
                "--train_data_types", "2dt", "2dt", "2dt", "2dt", "2dt", "2dt", "2dt", "2dt", "3d", 
                "--test_data_types", "3d", "2dt", "2d", "2dt", 
                "--snr_perturb_prob", "0.0", 
                "--optim_type", "sophia", 
                "--backbone_model", "STCNNT_HRNET", 
                "--a_type", "conv", 
                "--cell_type", "parallel", 
                "--cosine_att", "1", 
                "--att_with_relative_postion_bias", "0", 
                "--block_dense_connection", "1", 
                "--norm_mode", "instance2d", 
                "--mixer_type", "conv", 
                "--shuffle_in_window", "0", 
                "--scale_ratio_in_mixer", "1.0", 
                "--stride_s", "1", "--stride_t", "2", 
                "--wandb_dir", "/export/Lab-Xue/projects/mri/wandb", 
                "--backbone_hrnet.C", "32", 
                "--backbone_hrnet.num_resolution_levels", "2", 
                "--backbone_hrnet.block_str", "T1T1T1", "T1T1T1", 
                "--mixer_kernel_size", "3", 
                "--mixer_padding", "1", 
                "--mixer_stride", "1", 
                "--normalize_Q_K", 
                "--complex_i", 
                "--residual", 
                "--num_epochs", "1", 
                "--batch_size", "8", 
                "--post_backbone", "STCNNT_HRNET", 
                "--losses", "mse", "perpendicular", "psnr", "l1", "gaussian", "gaussian3D", "ssim", 
                "--loss_weights", "0.1", "1.0", "1.0", "1.0", "10.0", "10.0", "1.0", 
                "--min_noise_level", "12.0", "--max_noise_level", "24.0", 
                "--run_name", "1st", 
                "--run_notes", "1st", 
                "--n_head", "32",
                "--override", "--disable_LSUV"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "run.py, mri, 2nd stage",
            "type": "python",
            "request": "launch",
            "program": "./projects/mri/run.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--data_dir", "/data1/mri", 
                "--log_dir", "/export/Lab-Xue/projects/mri-main/logs", 
                "--summary_depth", "6", 
                "--device", "cuda", 
                //"--ddp", 
                "--project", "mri-main", 
                "--window_size", "8", "8", "--patch_size", "2", "2", 
                "--clip_grad_norm", "1.0", 
                "--optim.weight_decay", "1", 
                "--dropout_p", "0.1", 
                "--activation_func", "prelu", 
                "--iters_to_accumulate", "1", 
                "--prefetch_factor", "8", 
                "--scheduler_type", "ReduceLROnPlateau", 
                "--mri_height", "32", "64", 
                "--mri_width", "32", "64", 
                "--time", "12", 
                "--num_uploaded", "12", 
                "--snr_perturb", "10.0", 
                "--post_hrnet.block_str", "T1L1G1", "T1L1G1", 
                "--ratio", "0.1", "0.2", "100", 
                "--max_load", "-1", 
                "--model_type", "MRI_double_net", 
                "--train_files", "train_3D_3T_retro_cine_2018.h5", //"train_3D_3T_retro_cine_2019.h5", "train_3D_3T_retro_cine_2020.h5", "BARTS_RetroCine_3T_2023.h5", "BARTS_RetroCine_1p5T_2023.h5", "MINNESOTA_UHVC_RetroCine_1p5T_2023.h5", "MINNESOTA_UHVC_RetroCine_1p5T_2022.h5", 
                "--test_files", "train_3D_3T_retro_cine_2020_small_3D_test.h5", "train_3D_3T_retro_cine_2020_small_2DT_test.h5", "train_3D_3T_retro_cine_2020_small_2D_test.h5", "train_3D_3T_retro_cine_2020_500_samples.h5", 
                "--train_data_types", "2dt", "2dt", "2dt", "2dt", "2dt", "2dt", "2dt", "2dt", "3d", 
                "--test_data_types", "3d", "2dt", "2d", "2dt", 
                "--snr_perturb_prob", "0.0", 
                "--optim_type", "sophia", 
                "--backbone_model", "STCNNT_HRNET", 
                "--a_type", "conv", 
                "--cell_type", "parallel", 
                "--cosine_att", "1", 
                "--att_with_relative_postion_bias", "0", 
                "--block_dense_connection", "1", 
                "--norm_mode", "instance2d", 
                "--mixer_type", "conv", 
                "--shuffle_in_window", "0", 
                "--scale_ratio_in_mixer", "1.0", 
                "--stride_s", "1", "--stride_t", "2", 
                "--wandb_dir", "/export/Lab-Xue/projects/mri/wandb", 
                "--backbone_hrnet.C", "32", 
                "--backbone_hrnet.num_resolution_levels", "2", 
                "--backbone_hrnet.block_str", "T1T1T1", "T1T1T1", 
                "--mixer_kernel_size", "3", 
                "--mixer_padding", "1", 
                "--mixer_stride", "1", 
                "--normalize_Q_K", 
                "--complex_i", 
                "--residual", 
                "--num_epochs", "1", 
                "--batch_size", "8", 
                "--post_backbone", "STCNNT_HRNET", 
                "--losses", "mse", "perpendicular", "psnr", "l1", "gaussian", "gaussian3D", "ssim", "dwt", 
                "--loss_weights", "0.1", "1.0", "1.0", "1.0", "10.0", "10.0", "1.0", "1.0", 
                "--min_noise_level", "12.0", "--max_noise_level", "24.0", 
                "--run_name", "mri-omnivore_base", 
                "--run_notes", "mri-omnivore_base", 
                "--n_head", "32",
                "--override", "--disable_LSUV",
                "--freeze_pre", "True", "--freeze_backbone", "True", 
                "--pre_model_load_path", "/export/Lab-Xue/projects/mri/test//mri-main-1st_refactor_v2_STCNNT_HRNET_T1L1G1_T1L1G1T1L1G1_20231019_223024_948340_STCNNT_MRI_C-32-1_amp-True_complex_residual-T1L1G1_T1L1G1T1L1G1/best_checkpoint_epoch_49_pre.pth",
                "--backbone_model_load_path", "/export/Lab-Xue/projects/mri/test//mri-main-1st_refactor_v2_STCNNT_HRNET_T1L1G1_T1L1G1T1L1G1_20231019_223024_948340_STCNNT_MRI_C-32-1_amp-True_complex_residual-T1L1G1_T1L1G1T1L1G1/best_checkpoint_epoch_49_backbone.pth",
                //"--post_model_load_path", "/export/Lab-Xue/projects/mri/test//mri-main-1st_refactor_v2_STCNNT_HRNET_T1L1G1_T1L1G1T1L1G1_20231019_223024_948340_STCNNT_MRI_C-32-1_amp-True_complex_residual-T1L1G1_T1L1G1T1L1G1/best_checkpoint_epoch_49_post.pth"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "save_pt_as_onnx, mri",
            "type": "python",
            "request": "launch",
            "program": "./projects/mri/save_pt_as_onnx.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--input", "/export/Lab-Xue/projects/mri-main/logs/mri-main-1st_TTT_TTT_for_testing_STCNNT_HRNET_T1T1T1_T1T1T1_20231025_222045_958810_STCNNT_MRI_C-32-1_amp-True_complex_residual-T1T1T1_T1T1T1/mri-main-1st_TTT_TTT_for_testing_STCNNT_HRNET_T1T1T1_T1T1T1_20231025_222045_958810_STCNNT_MRI_C-32-1_amp-True_complex_residual-T1T1T1_T1T1T1_epoch-1.pth", "--output", "/export/Lab-Xue/projects/mri/test/test_model.pts"]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "create_hdf5_from_mat",
            "type": "python",
            "request": "launch",
            "program": "./projects/qperf/data/create_hdf5_from_mat.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "7"},
            "args": [
                "--output", "/export/Lab-Xue/data/qperf/h5file/qperf_tra.h5", "--test_output", "/export/Lab-Xue/data/qperf/h5file/qperf_test.h5", "--test_fraction", "0.1", "/export/Lab-Xue/data/qperf/mat"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "run.py, qperf",
            "type": "python",
            "request": "launch",
            "program": "./projects/qperf/run.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--data_dir", "/data/qperf/new_data", 
                "--log_dir", "/data/qperf/new_data/cache", 
                "--n_embd", "512",
                "--n_layer", "8", "12",
                "--use_pos_embedding",
                "--residual_dropout_p", "0.1",
                "--project", "QPerf",
                "--num_uploaded", "16",
                "--clip_grad_norm", "0.1",
                "--batch_size", "128", "--num_epochs", "12", "--use_amp", "--max_samples", "1024",
                "--foot_to_end", 
                "--optim_type", "sophia", "--optim.weight_decay", "0.1", 
                "--save_val_samples", "True",
                "--qperf_model_type", "QPerfModel_double_net",
                "--disable_LSUV",
                "--add_noise", "False", "False"
                // "--pre_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_pre.pth",
                // "--backbone_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_backbone.pth",
                // "--post_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_post.pth",
                // "--load_optim_and_sched", "True"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "run.py, qperf, btex",
            "type": "python",
            "request": "launch",
            "program": "./projects/qperf/run_btex.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--data_dir", "/data/qperf/new_data", 
                "--log_dir", "/data/qperf/new_data/cache", 
                "--n_embd", "512",
                "--n_layer", "8", "12",
                "--use_pos_embedding",
                "--residual_dropout_p", "0.1",
                "--project", "QPerf",
                "--num_uploaded", "16",
                "--clip_grad_norm", "0.1",
                "--batch_size", "128", "--num_epochs", "12", "--use_amp", "--max_samples", "1024",
                "--foot_to_end", 
                "--optim_type", "sophia", "--optim.weight_decay", "0.1", 
                "--save_val_samples", "True",
                "--qperf_model_type", "QPerfBTEXModel",
                "--disable_LSUV"
                // "--pre_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_pre.pth",
                // "--backbone_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_backbone.pth",
                // "--post_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_post.pth",
                // "--load_optim_and_sched", "True"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "run_param_model.py, qperf",
            "type": "python",
            "request": "launch",
            "program": "./projects/qperf/run_param_model.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--data_dir", "/data/qperf/new_data", 
                "--log_dir", "/data/qperf/new_data/cache", 
                "--n_embd", "512",
                "--n_layer", "8", "16",
                "--use_pos_embedding",
                "--residual_dropout_p", "0.1",
                "--project", "QPerf",
                "--num_uploaded", "16",
                "--clip_grad_norm", "0.1",
                "--batch_size", "128", "--num_epochs", "12", "--use_amp", "--max_samples", "1024",
                "--foot_to_end", 
                "--optim_type", "sophia", "--optim.weight_decay", "0.1", 
                "--save_val_samples", "True",
                "--disable_LSUV",
                "--add_noise", "False", "False",
                "--num_workers", "12",
                "--model_btex_load_path", "/export/Lab-Xue/projects/qperf/models/best_checkpoint_epoch_30",
                "--freeze_post", "True"
                // "--pre_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_pre.pth",
                // "--backbone_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_backbone.pth",
                // "--post_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_post.pth",
                // "--load_optim_and_sched", "True"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "torchrun, qperf, btex",
            "type": "python",
            "request": "launch",
            "program": "/home/xueh2/.local/bin/torchrun",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4,5"},
            "args": [
                "--standalone", "--nproc_per_node", "2",
                "./projects/qperf/run_btex.py", "--ddp",
                "--data_dir", "/data/qperf/new_data", 
                "--log_dir", "/data/qperf/new_data/cache", 
                "--n_embd", "512",
                "--n_layer", "8", "12",
                "--use_pos_embedding",
                "--residual_dropout_p", "0.1",
                "--project", "QPerf",
                "--num_uploaded", "16",
                "--clip_grad_norm", "0.1",
                "--batch_size", "128", "--num_epochs", "2", "--use_amp", "--max_samples", "1024",
                "--foot_to_end", 
                "--optim_type", "sophia", "--optim.weight_decay", "0.1", 
                "--save_val_samples", "True",
                "--qperf_model_type", "QPerfBTEXModel",
                "--disable_LSUV"
                // "--pre_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_pre.pth",
                // "--backbone_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_backbone.pth",
                // "--post_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_post.pth",
                // "--load_optim_and_sched", "True"
            ]
        },
        // -----------------------------------------------------------------------------------------
        {
            "name": "inference, qperf",
            "type": "python",
            "request": "launch",
            "program": "./projects/qperf/inference/run_inference.py",
            "justMyCode": true,
            "console": "integratedTerminal",
            "env": {"PYDEVD_WARN_EVALUATION_TIMEOUT": "10", "CUDA_VISIBLE_DEVICES": "4"},
            "args": [
                "--data_folder", "/export/Lab-Xue/data/qperf/test",
                "--output_dir", "/export/Lab-Xue/data/qperf/results",
                "--model", "/export/Lab-Xue/projects/qperf/models/best_checkpoint_epoch_0",
                "--max_samples", "2048"
                // "--pre_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_pre.pth",
                // "--backbone_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_backbone.pth",
                // "--post_model_load_path", "/data/qperf/cache/project_18-30-41-20231013/best_checkpoint_epoch_2_post.pth",
                // "--load_optim_and_sched", "True"
            ]
        }
    ]
}


